### 비지도학습(Unsupervised Learning)

답 안주고 스스로 배우게 하는 방법

데이터 라벨링 작업 필요 없음 = 시간비용단축 많은 데이터 쉽게 모아 학습

군집화 (Clustering)

데이터에서 패턴을 파악 데이터를 여러 개의 군집으로 나누는 것.
비슷한 데이터는 같은 그룹, 다른 데이터는 다른 그룹



## 군집화와 분류모델의 차이

### 군집화 vs. 분류 비교

| 특징 | 군집화 (Clustering) | 분류 (Classification) |
| --- | --- | --- |
| **학습 방법** | 비지도 학습 (Unsupervised Learning) | 지도 학습 (Supervised Learning) |
| **정답 유무** | 정답(레이블)이 없음 | 정답(레이블)이 이미 있음 |
| **목표** | 데이터 속 숨겨진 패턴 찾기, 
비슷한 것끼리 묶기 | 새로운 데이터의 정답 예측 |
| **예시** | 고객 세분화, 이미지 분할, 
뉴스 기사 토픽 찾기 | 이메일 스팸 분류, 암 진단, 
손글씨 숫자 인식 |

### Iris Dataset

꽃받침과 꽃잎의 길이/너비를 활용해 Iris(붓꽃)의 세부 종을 분류하는 데이터셋



### 분류 문제(classification)

모델의 출력값과 레이블을 비교. 모델이 점점 레이블에 가까운 출력을 내놓도록 학습.



### 비지도학습 후편

비지도학습은 단순히 라벨링 비용을 줄이려고 나온 게 아니라, 라벨이 없는 대량의 데이터에서 유용한 정보를 얻거나, 데이터의 숨겨진 구조를 파악하려는 **다른 종류의 문제**를 해결하기 위해 연구되는 기술

**매니폴드 가설** 

복잡한 데이터들이 실제로는 훨씬 낮은 차원의 '매니폴드(곡면 같은 개념)' 위에 존재한다.

매니폴드 가설을 바탕으로 비지도학습이 뭘 할 수 있는가

1. **데이터 간소화:** 복잡한 데이터를 더 간단하게 만들거나(차원 축소), 지저분한 걸 없애고(노이즈 제거), 눈으로 보기 쉽게(시각화) 함
2. **숨겨진 패턴 찾기:** 데이터 속에 어떤 그룹이 있는지(군집화), 이상한 건 없는지(이상 탐지) 찾아냄
3. **새로운 데이터 만들기/이해하기:** 기존 데이터를 바탕으로 새로운 데이터를 만들거나(생성 모델), 데이터의 진짜 의미를 스스로 파악하는(표현 학습) 방법을 연구

핵심, **정답(레이블) 없이도 데이터를 똑똑하게 다루는 방법들이다.**

차원축소를 하면 정보가 유실된다는 사실을 역으로 활용해,
원본 데이터의 노이즈를 제거하는 방식으로 활용할 수도 있다.

### **군집화(Clustering)**

- **k-Means:** 가장 널리 쓰이는 방법 중 하나, 데이터를 정해진 k개의 그룹으로 나누고,
- 각 그룹의 평균을 찾아 데이터들을 가장 가까운 중심에 할당하는 과정을 반복.

- **DBSCAN**  밀도를 기반으로 군집을 찾아내는 방법.
- 데이터가 밀집된 곳을 군집으로 보고, 밀집되지 않은 곳에 있는 데이터는 노이즈로 처리

- **중요한 특징**
- 이전의 차원 축소와는 다르게, 군집화는 데이터를 다른 형태로 '변형(압축)'하지 않는다.
- 데이터의 원래 특성은 그대로 두고 그룹만 나눈다.

### 임베딩 공간의 활용

### 단어의 임베딩(Word to Vector)

자연어처리(NLP)라는 분야에서 쓰이는 기술

우리가 사용하는 영어 같은 **'자연어 단어'들을** 

**컴퓨터가 이해하고 계산할 수 있는 '숫자 벡터(점)'로 바꾸는 기술**

중요한 건 그냥 숫자로 바꾸는 게 아니라, 

이렇게 바뀐 **숫자들(점) 사이에 '의미적인 연산'이 가능**하다는 점



King에서 Queen으로 가는 벡터(화살표)는 '남성'에서 '여성'으로의 변화를 나타냄

놀랍게도, Prince에서 Princess로 가는 벡터(화살표)도 그 방향과 길이가 비슷함

이게 바로 **'의미적인 연산'이 가능하다는 뜻**. 

임베딩 공간에서 벡터 연산을 하면

**King - Man + Woman = Queen** (남성 왕에서 남성을 빼고 여성을 더하면 여성 왕이 된다)

**Prince - Boy + Girl = Princess** (남성 왕자에서 남자를 빼고 여자를 더하면 여성 공주가 된다)

이런 식으로 단어들 간의 의미적 관계(성별, 직업, 국가-수도 등)가 

숫자 벡터들의 기하학적 관계(거리, 방향)로 표현되는 것이 단어 임베딩의 핵심

### 생성모델(generative model)

컴퓨터가 **새로운 이미지나 내용**을 만드는 기술
아이디어(저차원 임베딩 공간)를 주면, 그걸 바탕으로 세상에 없던 결과물을 만들어냄

---

## 고차원 데이터의 이해

**고차원 데이터**는 **정보(특징)가 아주 많은 데이터**

왜 고차원 데이터가 필요하지?
핵심: **우리가 사는 '현실' 자체가 고차원적인 정보를 담고 있기 때문**

예시)

**하드웨어 발전:** 스마트폰 카메라 같은 장비들이 발전, 더 많은 정보를 담은 데이터를 만들어냄 
**스마트폰 사진:** 몇백, 몇천만 픽셀로 구성돼서 이미지 하나가 엄청난 양의 정보를 가짐.
**동영상:** 초당 수십 장 이상의 이미지(픽셀 정보)가 계속 이어지는 데이터.
**음성 데이터:** 1초에 수만 개의 숫자로 소리 정보를 담아냄.

물론 `resize` 같은 방법으로 데이터의 차원(정보량)을 낮출 수도 있지만, 

그렇게 하면 **정보 손실이 생김**

예시) 화질 낮추면 디테일이 사라짐

또한 데이터를 표현하는데 필요한 차원이 부족할 경우, 제대로된 분석이 힘들 수 있다.

## 고차원에서 생기는 문제점들

1. 컴퓨터 자원의 사용량

데이터의 차원 수가 커질수록(데이터가 복잡해질수록)

1) 모델도 더 커진다

2) 연산량,메모리 사용량 증가

3)오래 기다려야함

4)더 좋은/비싼 장비 필요

1. 차원에 따른 데이터의 희소성 문제

차원이 높아질수록 데이터가 점점 더 텅 빈 공간에 흩어지게 된다는 뜻

- **Dimension = 1 (1차원):** 점들이 한 줄에 빼곡히 모여 있음. (밀도가 높음)
- **Dimension = 2 (2차원):** 같은 수의 점들이지만, 넓은 평면에 퍼지니 1차원보다 듬성듬성함
- **Dimension = 3 (3차원):** 더 넓은 입체 공간에 퍼지니, 2차원보다 훨씬 더 비어있어 보임
- **Dimension = 100 (?):** 100차원 같은 고차원 공간에서는,
- 상상할 수 없을 정도로 데이터들이 서로 멀리 떨어져 있어서 공간 대부분이 텅 비게 돼.

결과 

**데이터 간의 거리가 기하급수적으로 증가:** 점들 사이가 너무 멀어짐
공간 내 데이터의 밀도가 낮아짐 (희소성 증가)
이렇게 흩어져 있으면 모델이 학습하기 어려움 ( 차원의 저주 라고도 부름 )

1. 직관적으로 이해하기 힘든 고차원 공간

익숙하다고 생각한 개념들이 고차원 공간에서는 말도 안되는 특성을 보임



---

## 추천시스템이란?

데이터로 사람들이 뭘 좋아할지 예측해서 원하는 걸 보여주는 머신러닝의 한 종류

예) 넷플릭스,유튜브

사용자(User) : 추천을 받는 대상

아이템 or 콘텐츠 : 추천되는 대상

활동 기록 : 사용자의 모든 행동에 대한 기록

피드백 : 특정 아이템에 대한 사용자의 선호, 또는 비선호를 드러낼 수 있는 행동



추천 시스템의 구성요소

유저 프로필 :  활동기록과 피드백을 통해 수집한 유저에 대한 정보를 모아놓은 데이터

## ML강의에 추천시스템이 있는 이유

**기업 수익과 연결되어 다양한 형태의 데이터와 문제점**을 다루고 오래전부터 연구했기 때문

## 다양한 형태의 추천시스템

스트리밍 서비스 (콘텐츠 추천)

넷플릭스

유튜브

멜론

네이버웹툰



소셜 네트워크 서비스

콘텐츠 피드

친구, 팔로우 제안

유해정보, 혐오표현, 가짜뉴스 필터핑



교육 서비스

학생이 어떤 유형의 문제를 틀리는지 확인. 비슷한 유형의 문제나 공부해볼 분야 추천

헬스케어 서비스

개인의 건강기록에 기반해서, 혹은 특정 연령대의 사람들에게 적합한 의료서비스를 추천

금융 서비스

고객의 신용정보, 소비 패턴 등에 맞춰 금융상품이나 신용카드 등 서비스 추천

NOTE: 건강기록이나 금융정보 등은 매우 민감한 개인정보이기에  함부로 다루면 문제가 생길 수 있다.

광고 플랫폼의 추천시스템
우리가 웹페이지나 앱에서 광고 하나를 보기전 1초 남짓의 시간동안 수많은 회사들이
(물론 전부 자동화된 프로세스로)
광고 자리를 두고 경쟁 입찰에 참여한다



---

## 어떤 입력값을 활용하지?

유저 프로필 :  활동기록과 피드백을 통해 수집한 유저에 대한 정보를 모아놓은 데이터

아이템 프로필 : 다양한 방식으로 수집된 콘텐츠에 대한 정보(같은 장르, 같은배우 등)

유저의 피드백 정보 :

직접적인 평가                             ⇒ 0 or 1~5점
선호/비선호 표시                       ⇒ 0 or 1/-1
 (구매 등)상호작용 있음/없음   ⇒ 0 or 1



어떤 결과 값을 예측하지?

분류 모델링
●특정 유저가 다음으로 클릭할 아이템
●특정 유저가 특정 아이템을 구매할지 아닐지

회귀 모델링
●유저의 특정 아이템에 대한 선호도(평점) 예측

비지도학습
●아이템간, 유저의 선호도 패턴간의 유사성 판단
●특정 유저가 선호할만한 아이템의 순위 예측 (Ranking based)

---

## 추천시스템의 세부분류



인기도 기반 추천

조회수, 평균 평점, 리뷰 개수, 좋아요/싫어요 등의 사용자 피드백 정보를 활용

가장 인기 있는 아이템을 새로운 유저에게 추천



모든 사용자에게 같은 추천을 제공하는 비개인화 추천 방식
어떻게 인기도를 측정, 비교하는가에 따라 상당히 고도화된 방식들도 존재한다.

사용자의 추천/비추천과 게시물이 올라온 시간까지 고려해 인기도를 측정하는 레딧 공식
웹페이지간의 상호 연결관계를 활용하는 구글의 페이지 랭크방식



연관규칙 추천

 동시에 등장하는 빈도가 높은 컨텐츠의 조합을 찾아내는 방법론

특정 상품을 장바구니에 담으면, 다른 유저가 그 상품과 함께 구매한 상품들을 추천해주는 방식

세부 방법론
● Brute Force                        : 모든 경우의 수 다 확인
● Apriori Algorithm             : 자주 나타나는 것들 먼저 찾아보는 방법
● FP-Growth Algorithm     : 데이터 압축. 트리구조로 쓱 훑어보고 규칙 찾기

콘텐츠 기반 추천

스릴러 장르를 선호하는 유저에게 다른 스릴러 장르의 영화를 추천하는 방식

---

협업 필터링

사용자들, 또는 아이템 사이의 유사성을 기반으로 작동하는 추천시스템 방식

유사성 어떻게 판단하나?

1.메모리 기반

데이터를 있는 그대로 사용해서 유사성을 계산

사용자 기반 (User Based): **사람들끼리 뭘 얼마나 비슷하게 평가했는지**를 봄
아이템 기반 (Item Based): 아**이템들끼리 어떤 사용자들이 비슷하게 평가했는지**를 봄

2.잠재 요인 분석

데이터에 숨은 잠재적 특징을 찾아내 유사성을 판단

예) 영화 데이터에 액션 코미디 요소 많은데 저 사용자는 액션 좋아하네? (행렬분해)

코사인 유사도

두 가지 대상이 얼마나 비슷한지를 숫자 하나로 알려주는 방법
특히, 이 두 대상을 '벡터'라는 수학적 개념으로 표현했을 때, 

그 **두 벡터가 얼마나 같은 방향을 가리키는지**를 가지고 유사도를 판단



기억 기반 협업 필터링

과거 데이터를 직접 활용 나랑 비슷한 사람or 내가 좋아하는 거랑 비슷한 물건을 찾아 추천해주는 방식

사용자-아이템 선호도 행렬
모든 사용자-아이템 쌍에 대해, 사용자의 아이템에 대한 선호도를 수치로 나타낸 행렬

다양한 피드백 정보를 활용해 구축할 수 있다.
●직접적인 평가 ⇒ 0(정보없음) 또는 1~5점
●선호/비선호 표시 ⇒ 0 또는 1/-1
● (구매 등)상호작용 있음/없음 ⇒ 0 또는 1



사용자 기반 협업 필터링



아이템 기반 협업 필터링



잠재 요인(Latent Factor)분석
사용자와 아이템 간의 복잡한 관계를 직접 파고드는 대신, 그 관계를 설명할 수 있는 **몇 가지 '핵심적인 숨겨진 특징(잠재 요인)'들을 찾아내서** 더 효율적이고 정확하게 추천하는 고급 방법


잠재 요인

숨겨져 있는 중요한 특징

의사가 환자의 증상을 보고 바로 알 수 없는 '병의 원인을 진단해내는 것과 비슷

협업 필터링 방식의 한계점

콜드스타트(Cold Start)문제
유저의 선호도 패턴을 파악하려면 어느정도 데이터가 필요,
선호도 데이터가 없는 신규 유저의 경우 정확한 추천을 제공하기 힘들다.

개인정보(Privacy) 문제
서비스의 이용자 본인이 아닌 다른 이용자의 정보를 저장하고 이를 기반으로
추천을 제공하기 때문에, 개인정보 처리와 관련된 법률적 문제 등이 생기기 쉽다.

시간에 따른 선호도 변화 문제
사용자의 취향은 고정된 것이 아니라 시간에 따라 변화할 수 있는데, 협업필터링
방식의 추천시스템에서는 이를 반영하기 힘들다.
